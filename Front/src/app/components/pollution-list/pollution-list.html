<div class="list-container">
  <div class="page-header">
    <h2>Liste des Pollutions</h2>
    <button class="btn-create" (click)="onCreateNew()">
      ‚ûï Signaler une pollution
    </button>
  </div>

  <div class="filters">
    <div class="filter-group">
      <label>Type :</label>
      <select [ngModel]="filterType()" (ngModelChange)="filterType.set($event); applyFilters()">
        <option value="">Tous</option>
        <option value="Plastique">Plastique</option>
        <option value="Chimique">Chimique</option>
        <option value="D√©p√¥t sauvage">D√©p√¥t sauvage</option>
        <option value="Eau">Eau</option>
        <option value="Air">Air</option>
        <option value="Autre">Autre</option>
      </select>
    </div>

    <div class="filter-group">
      <label>Gravit√© :</label>
      <select [ngModel]="filterSeverity()" (ngModelChange)="filterSeverity.set($event); applyFilters()">
        <option value="">Toutes</option>
        <option value="low">Faible</option>
        <option value="medium">Moyenne</option>
        <option value="high">√âlev√©e</option>
        <option value="critical">Critique</option>
      </select>
    </div>

    <div class="filter-group">
      <label>Statut :</label>
      <select [ngModel]="filterStatus()" (ngModelChange)="filterStatus.set($event); applyFilters()">
        <option value="">Tous</option>
        <option value="reported">Signal√©</option>
        <option value="in-progress">En cours</option>
        <option value="resolved">R√©solu</option>
      </select>
    </div>
  </div>

  @if (loading()) {
    <div class="loading">Chargement en cours...</div>
  }

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }

  @if (!loading() && !error()) {
    <div class="pollution-grid">
      @for (pollution of pollutions(); track pollution.id) {
        <div class="pollution-card" (click)="onViewDetail(pollution)">
          <div class="card-header">
            <span class="type-icon">{{ getTypeIcon(pollution.type) }}</span>
            @if (pollution.severity) {
              <span class="severity-badge" [ngClass]="getSeverityClass(pollution.severity)">
                {{ pollution.severity }}
              </span>
            }
          </div>

          <h3>{{ pollution.title }}</h3>
          <p class="location">üìç {{ pollution.location }}</p>
          <p class="description">{{ pollution.description }}</p>

          <div class="card-footer">
            @if (pollution.status) {
              <span class="status">{{ pollution.status }}</span>
            }
            @if (pollution.reportedDate) {
              <span class="date">{{ pollution.reportedDate | date:'dd/MM/yyyy HH:mm' }}</span>
            }
          </div>

          <div class="card-actions">
            <button
              class="btn-edit"
              (click)="onEdit(pollution, $event)"
              title="Modifier">
              ‚úèÔ∏è
            </button>
            <button
              class="btn-delete"
              (click)="onDelete(pollution.id, $event)"
              title="Supprimer">
              üóëÔ∏è
            </button>
          </div>
        </div>
      } @empty {
        <div class="no-data">Aucune pollution trouv√©e</div>
      }
    </div>
  }
</div>
